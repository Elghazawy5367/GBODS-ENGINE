<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GBODS ENGINE V5 PRO</title>
  <meta name="description" content="Gold-Based Opportunity Discovery System ‚Äî Find unnamed pain at niche intersections using AI-powered 8-stage analysis">
  <link rel="icon" href="assets/favicon.svg" type="image/svg+xml">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/engine.css">
</head>
<body>
<div class="app">

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SETTINGS OVERLAY ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="settings-overlay" id="settingsOverlay">
    <div class="settings-panel">
      <div class="settings-title">
        <span>‚öô Settings</span>
        <button class="settings-close" onclick="toggleSettings()">‚úï</button>
      </div>
      <div class="field">
        <label class="field-label">OpenRouter API Key</label>
        <input type="password" id="apiKey" placeholder="sk-or-v1-..." oninput="saveSettings()">
        <div class="field-hint">Stored locally only. Get at <span style="color:var(--gold)">openrouter.ai/keys</span></div>
      </div>
      <div class="field" style="margin-top:16px">
        <label class="field-label">Analysis Model</label>
        <div class="model-grid" id="modelGrid"></div>
      </div>
      <div class="btn-row" style="margin-top:20px">
        <a href="https://openrouter.ai/keys" target="_blank" class="btn btn-cyan btn-sm">Get API Key ‚Üó</a>
        <button class="btn btn-ghost btn-sm" onclick="toggleSettings()">Close</button>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HISTORY DRAWER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="history-drawer" id="historyDrawer">
    <div class="history-drawer-header">
      <div class="history-drawer-title">ANALYSIS HISTORY</div>
      <button class="history-close" onclick="toggleHistory()">‚úï</button>
    </div>
    <div class="history-list" id="historyList"></div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SCREEN: SETUP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="screen active" id="screenSetup">
    <div class="topbar">
      <div class="topbar-logo">
        <div class="logo-gem"></div>
        <div><div class="logo-text">GBODS ENGINE</div></div>
        <div class="logo-version">V5 PRO</div>
      </div>
      <div class="topbar-spacer"></div>
      <div class="topbar-status" id="statusBar">
        <div class="status-dot" id="statusDot"></div>
        <span id="statusText">Configure</span>
      </div>
      <button class="btn-topbar" onclick="toggleSettings()" title="Settings (S)">‚öô</button>
    </div>

    <div class="steps-nav">
      <div class="step-item active" id="stepNav1" onclick="goStep(1)"><div class="step-num">1</div><span>Profile</span></div>
      <div class="step-sep"></div>
      <div class="step-item" id="stepNav2" onclick="goStep(2)"><div class="step-num">2</div><span>Intersection</span></div>
      <div class="step-sep"></div>
      <div class="step-item" id="stepNav3"><div class="step-num">3</div><span>Intelligence</span></div>
    </div>

    <!-- STEP 1: PROFILE -->
    <div class="page" id="step1" style="padding-top:24px">
      <div class="card">
        <div class="card-title"><span class="card-title-icon">üë§</span> Constraint Profile</div>
        <div class="grid2">
          <div class="field">
            <label class="field-label">Role</label>
            <input type="text" id="role" value="Solo non-technical founder">
          </div>
          <div class="field">
            <label class="field-label">Monthly Income Goal</label>
            <input type="text" id="income" value="$2,000‚Äì5,000/month">
          </div>
          <div class="field">
            <label class="field-label">Days to First Revenue</label>
            <input type="number" id="timeline" value="7" min="1" max="90">
          </div>
          <div class="field">
            <label class="field-label">Weekly Hours Available</label>
            <input type="number" id="hours" value="20" min="1" max="80">
          </div>
          <div class="field">
            <label class="field-label">Budget</label>
            <input type="text" id="budget" value="$0‚Äì100">
          </div>
          <div class="field">
            <label class="field-label">Technical Skills</label>
            <input type="text" id="skills" value="None ‚Äî no coding">
          </div>
        </div>
        <div class="field">
          <label class="field-label">Hard Constraints</label>
          <textarea id="constraints">No team, no SaaS, no ongoing client work, passive digital delivery only</textarea>
        </div>
        <div id="constraintWarnings"></div>
      </div>
      <div class="btn-row right">
        <button class="btn btn-gold" onclick="goStep(2)">Next: Set Intersection ‚Üí</button>
      </div>
    </div>

    <!-- STEP 2: NICHES -->
    <div class="page" id="step2" style="display:none">
      <div class="math-display" id="mathEq">V‚ÇÅ √ó V‚ÇÇ = Blue Ocean Potential</div>
      <div class="card">
        <div class="card-title"><span class="card-title-icon">üéØ</span> Niche Vectors</div>
        <div class="field">
          <label class="field-label">V1 ‚Äî Base Niche <span class="field-req">*</span></label>
          <input type="text" id="v1" placeholder="e.g., ADHD freelance designers" oninput="updateMath()">
          <div class="field-hint">Primary identity group</div>
        </div>
        <div class="field">
          <label class="field-label">V2 ‚Äî Intersection Niche <span class="field-req">*</span></label>
          <input type="text" id="v2" placeholder="e.g., Etsy digital product sellers" oninput="updateMath()">
          <div class="field-hint">Platform or context where pain occurs</div>
        </div>
        <div class="field">
          <label class="field-label">V3 ‚Äî Deepening <span style="color:var(--txt3)">(optional)</span></label>
          <input type="text" id="v3" placeholder="e.g., Notion template creators under 500 sales" oninput="updateMath()">
          <div class="field-hint">Sub-community to narrow further</div>
        </div>
      </div>
      <div class="btn-row" style="justify-content:space-between">
        <button class="btn btn-ghost" onclick="goStep(1)">‚Üê Back</button>
        <button class="btn btn-gold" onclick="goToIntelligence()" id="btnIntelligence">
          <span class="btn-icon">‚ú¶</span> Scout Intersection ‚Üí
        </button>
      </div>
    </div>

    <!-- STEP 3: INTELLIGENCE -->
    <div class="page" id="step3" style="display:none">
      <div class="card" id="lensCard">
        <div class="card-title"><span class="card-title-icon">üîç</span> Smart Lenses <span class="card-title-sub">select 1‚Äì3</span></div>
        <div class="lenses-ai-banner" id="lensAiBanner" style="display:none">
          <span>‚ú¶</span> <span id="lensAiText"></span>
        </div>
        <div class="lenses-wrap" id="lensGrid"></div>
      </div>

      <div class="whispers-card">
        <div class="whispers-header" onclick="toggleWhispers()">
          <div class="whispers-title"><span>üì°</span> Web Whispers <span style="font-size:10px;font-weight:400;color:var(--txt3);text-transform:none;letter-spacing:0;font-family:'Outfit',sans-serif">‚Äî trend signals</span></div>
          <div class="whisper-toggle" id="whisperToggle"></div>
        </div>
        <div class="whispers-body" id="whispersBody">
          <div class="whisper-desc">Instructs AI to surface platform changes, conversations, tool launches, and cultural shifts at your intersection.</div>
          <div class="field">
            <label class="field-label" style="margin-top:8px">Focus Signals <span style="color:var(--txt3)">(optional)</span></label>
            <textarea id="whisperFocus" placeholder="e.g., recent fee changes, burnout discourse, AI adoption..."></textarea>
          </div>
        </div>
      </div>

      <div class="card" id="painScoutArea" style="display:none">
        <div class="card-title"><span class="card-title-icon">üéØ</span> Pain Scout <span class="card-title-sub">‚Äî click to focus</span></div>
        <div class="pain-scout-pills" id="painPills"></div>
        <div class="field-hint" style="margin-top:10px">Candidate pains at your intersection. Select one to focus analysis.</div>
      </div>

      <div class="card">
        <div class="card-title"><span class="card-title-icon">‚ö°</span> Enrichments</div>
        <div class="enrich-grid" id="enrichGrid"></div>
      </div>

      <div class="card">
        <div class="card-title"><span class="card-title-icon">‚öô</span> Output Config</div>
        <div class="grid2">
          <div class="field">
            <label class="field-label">Opportunities</label>
            <select id="depth" onchange="updateTokenEst()">
              <option value="5">5 ‚Äî Full Scan</option>
              <option value="3">3 ‚Äî Focused</option>
              <option value="1">1 ‚Äî Executive</option>
            </select>
          </div>
          <div class="field">
            <label class="field-label">Model</label>
            <select id="modelSelect" onchange="setModelFromSelect()"></select>
          </div>
        </div>
        <div class="token-est" id="tokenEst">
          <span>‚âà</span> <span id="tokenCount">~4,500 tokens</span>
          <span>¬∑</span> <span class="cost" id="tokenCost">~$0.01</span>
        </div>
      </div>

      <div class="btn-row" style="justify-content:space-between">
        <button class="btn btn-ghost" onclick="goStep(2)">‚Üê Back</button>
        <button class="btn btn-gold" onclick="runAnalysis()" id="btnRun" style="font-size:15px;padding:12px 28px">‚ö° Run GBODS Analysis</button>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SCREEN: ANALYSIS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="screen" id="screenAnalysis">
    <div class="topbar">
      <div class="topbar-logo">
        <div class="logo-gem"></div>
        <div class="logo-text">GBODS ENGINE</div>
        <div class="logo-version">V5 PRO</div>
      </div>
      <div class="topbar-spacer"></div>
      <div class="topbar-status">
        <div class="status-dot thinking"></div>
        <span id="analysisStatusText">Initializing‚Ä¶</span>
      </div>
      <button class="btn btn-red btn-sm" id="btnAbort" onclick="abortAnalysis()" style="display:none">‚úï Abort</button>
    </div>
    <div class="analysis-wrap">
      <div class="analysis-sidebar">
        <div class="analysis-profile-card">
          <div class="apc-title">INTERSECTION</div>
          <div class="apc-row" id="analysisIntersection" style="font-size:12px;color:var(--txt);font-family:'JetBrains Mono',monospace;line-height:1.7"></div>
        </div>
        <div class="stage-indicator">
          <div class="stage-indicator-title">STAGES</div>
          <div id="stageList"></div>
        </div>
        <div class="analysis-profile-card">
          <div class="apc-title">PROFILE</div>
          <div class="apc-row" id="analysisProfile"></div>
        </div>
      </div>
      <div class="analysis-main">
        <div id="thinkingBox" class="card" style="min-height:200px;display:flex;align-items:center;justify-content:center;">
          <div class="analysis-thinking">
            <div class="thinking-spinner"></div>
            <div class="thinking-label" id="thinkingLabel">Preparing analysis‚Ä¶</div>
            <div class="thinking-sub" id="thinkingSub">Building optimized prompt</div>
          </div>
        </div>
        <div class="stream-box" id="streamBox" style="display:none"></div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SCREEN: RESULTS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="screen" id="screenResults">
    <div class="topbar">
      <div class="topbar-logo">
        <div class="logo-gem"></div>
        <div class="logo-text">GBODS ENGINE</div>
        <div class="logo-version">V5 PRO</div>
      </div>
      <div class="topbar-spacer"></div>
      <div class="topbar-status">
        <div class="status-dot live"></div>
        <span>Analysis Complete</span>
      </div>
      <button class="btn-topbar" onclick="toggleSettings()">‚öô</button>
    </div>
    <div class="results-header">
      <div class="results-meta" id="resultsMeta"></div>
    </div>
    <div class="results-body">
      <div class="insight-card" id="topRecCard" style="display:none">
        <div class="top-rec-label">‚óÜ TOP RECOMMENDATION</div>
        <div class="top-rec-title" id="topRecTitle"></div>
        <div class="top-rec-reason" id="topRecReason"></div>
      </div>
      <div class="insight-card" id="systemInsightCard" style="display:none">
        <div class="insight-label">‚óà SYSTEM INSIGHT ‚Äî Meta-Pattern</div>
        <div class="insight-text" id="systemInsightText"></div>
      </div>
      <div class="opp-grid" id="oppGrid"></div>
      <div class="card" id="h72Card" style="display:none">
        <div class="card-title"><span class="card-title-icon">‚ö°</span> First 72 Hours</div>
        <div class="hours-plan" id="hoursPlan"></div>
      </div>
      <div class="btn-row center" style="margin-top:24px">
        <button class="btn btn-outline" onclick="exportJSON()">‚Üì JSON</button>
        <button class="btn btn-outline" onclick="exportMarkdown()">‚Üì Markdown</button>
        <button class="btn btn-ghost" onclick="newAnalysis()">+ New Analysis</button>
      </div>
    </div>
  </div>

  <button class="history-btn" onclick="toggleHistory()" id="historyFab" style="display:none">‚ä°</button>
  <div class="kbd-hint"><kbd class="kbd">S</kbd> settings ¬∑ <kbd class="kbd">H</kbd> history ¬∑ <kbd class="kbd">Esc</kbd> close</div>
  <div class="toast" id="toast"></div>
</div>

<!-- Module load order matters -->
<script src="js/data.js"></script>
<script src="js/utils.js"></script>
<script src="js/radar.js"></script>
<script src="js/history.js"></script>
<script src="js/export.js"></script>
<script src="js/ui.js"></script>
<script src="js/engine.js"></script>
<script src="js/app.js"></script>
</body>
</html>
